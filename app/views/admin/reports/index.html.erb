<div class="title">
  <h3>系统报告</h3>
</div>

<div class="counting">
  <span class="text">统计：</span><span class="count">会员数：<%= @user.count %></span><span class="count">活动数：<%= Event.count %></span><span class="count">话题数：<%= Topic.count %></span><span class="count">评论数：<%= Comment.count %></span>
</div>
<div class="content">
  <table>
    <tr class="title">
      <th>用户id</th>
      <th>用户昵称</th>
      <th>用户名字</th>
      <th>参与活动</th>
      <th>参与话题</th>
      <th>发表活动</th>
      <th>发表话题</th>
    </tr>
    <% @user.each_with_index do |user| %>
    <tr class="body">
      <td><%= user.id %></td>
      <td><%= user.username %></td>
      <td><%= user.name %></td>
      <td><%= Participant.where(user_id: user.id).count %></td>
      <td><%= user.comments.group(:topic_id).count.select {|key, value|key.present?}.count %></td>
      <td><%= user.events.count.to_i %></td>
      <td><%= user.topics.count.to_i %></td>
    </tr>
    <% end %>
  </table>
  <div class="paginate">
    <%= will_paginate @user %>
  </div>
</div>